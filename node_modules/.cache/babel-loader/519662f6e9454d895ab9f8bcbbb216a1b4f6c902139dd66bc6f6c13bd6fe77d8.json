{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\OUSSAMA CHAROUK\\\\Downloads\\\\FullStack_Ecommerce_App-main\\\\frontend\\\\src\\\\pages\\\\CheckoutPage.js\",\n  _s = $RefreshSig$();\n// src/pages/CheckoutPage.js\nimport React, { useEffect, useMemo, useState } from \"react\";\nimport axios from \"axios\";\nimport { Alert } from \"react-bootstrap\";\nimport { Link, useHistory } from \"react-router-dom\";\nimport { useCart } from \"../cart/CartProvider\";\nimport \"./checkout.css\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst FALLBACK_RATES = [{\n  city: \"Casablanca\",\n  price: 20\n}, {\n  city: \"Ain Harouda\",\n  price: 30\n}, {\n  city: \"Bouskoura\",\n  price: 30\n}, {\n  city: \"Dar Bouazza\",\n  price: 30\n}, {\n  city: \"Errahma ville\",\n  price: 30\n}, {\n  city: \"Tamaris\",\n  price: 30\n}, {\n  city: \"Tit Mellil\",\n  price: 30\n}, {\n  city: \"Agadir\",\n  price: 35\n}, {\n  city: \"Ait Melloul\",\n  price: 35\n}, {\n  city: \"Berrechid\",\n  price: 35\n}, {\n  city: \"Marrakech : Tamansourt\",\n  price: 45\n}, {\n  city: \"Mohammedia : Mimosa\",\n  price: 45\n}, {\n  city: \"Livraison pour toutes les autres villes\",\n  price: 45\n}];\nexport default function CheckoutPage() {\n  _s();\n  const history = useHistory();\n  const {\n    items,\n    totals,\n    clear\n  } = useCart();\n  const [email, setEmail] = useState(\"\");\n  const [first, setFirst] = useState(\"\");\n  const [last, setLast] = useState(\"\");\n  const [addr, setAddr] = useState(\"\");\n  const [apt, setApt] = useState(\"\");\n  const [zip, setZip] = useState(\"\");\n  const [city, setCity] = useState(\"\");\n  const [phone, setPhone] = useState(\"\");\n  const [rates, setRates] = useState(FALLBACK_RATES);\n  const [shippingPrice, setShippingPrice] = useState(0);\n  const [loading, setLoading] = useState(false);\n  const [err, setErr] = useState(\"\");\n\n  // load shipping rates (public endpoint already added in your backend)\n  useEffect(() => {\n    let alive = true;\n    (async () => {\n      try {\n        const {\n          data\n        } = await axios.get(\"/api/shipping-rates/\");\n        if (!alive) return;\n        if (Array.isArray(data) && data.length) {\n          const normalized = data.filter(r => r.active !== false).map(r => ({\n            city: r.city,\n            price: Number(r.price)\n          })).sort((a, b) => a.city.localeCompare(b.city, \"fr\"));\n          setRates(normalized);\n        }\n      } catch {\n        // fallback already set\n      }\n    })();\n    return () => {\n      alive = false;\n    };\n  }, []);\n\n  // preselect Casablanca (or first rate)\n  useEffect(() => {\n    if (!rates.length) return;\n    const defaultRate = rates.find(r => r.city === \"Casablanca\") || rates[0];\n    setCity(defaultRate.city);\n    setShippingPrice(defaultRate.price);\n  }, [rates]);\n  const total = useMemo(() => (totals.subtotal || 0) + Number(shippingPrice || 0), [totals.subtotal, shippingPrice]);\n  const submit = async () => {\n    setErr(\"\");\n    if (!items.length) {\n      setErr(\"Votre panier est vide.\");\n      return;\n    }\n    if (!addr || !city || !phone) {\n      setErr(\"Adresse, ville et téléphone sont obligatoires.\");\n      return;\n    }\n    setLoading(true);\n    try {\n      const payload = {\n        // order summary\n        items: items.map(i => ({\n          id: i.id,\n          name: i.name,\n          price: Number(i.price),\n          qty: Number(i.qty || 1),\n          variant: i.variantLabel || \"\"\n        })),\n        subtotal: Number(totals.subtotal),\n        shipping_price: Number(shippingPrice),\n        total: Number(total),\n        // contact + shipping address\n        email: (email || \"\").trim(),\n        first_name: (first || \"\").trim(),\n        last_name: (last || \"\").trim(),\n        address: `${addr}${apt ? \", \" + apt : \"\"}${zip ? \", \" + zip : \"\"}`.trim(),\n        city,\n        phone: (phone || \"\").trim(),\n        // payment method\n        payment_method: \"cod\" // cash on delivery\n      };\n\n      // New backend endpoint below\n      const {\n        data\n      } = await axios.post(\"/api/checkout/cod/\", payload);\n      // Save for the status page\n      localStorage.setItem(\"lastOrderId\", String(data.order_id));\n      clear(); // empty cart after placing order\n      history.push(`/payment-status?order=${data.order_id}`);\n    } catch (e) {\n      var _e$response, _e$response$data;\n      setErr((e === null || e === void 0 ? void 0 : (_e$response = e.response) === null || _e$response === void 0 ? void 0 : (_e$response$data = _e$response.data) === null || _e$response$data === void 0 ? void 0 : _e$response$data.detail) || e.message || \"Erreur serveur\");\n    } finally {\n      setLoading(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"co-wrap\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"co-left\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"co-title\",\n        children: \"Contact\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"co-field\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"E-mail ou num\\xE9ro de portable\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          value: email,\n          onChange: e => setEmail(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"co-title\",\n        children: \"Livraison\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"co-grid-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"co-field\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Pr\\xE9nom (optionnel)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 142,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            value: first,\n            onChange: e => setFirst(e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 143,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 141,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"co-field\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Nom\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 146,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            value: last,\n            onChange: e => setLast(e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 147,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"co-field\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Adresse\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          value: addr,\n          onChange: e => setAddr(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 153,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"co-grid-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"co-field\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Appartement, suite, etc. (optionnel)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 158,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            value: apt,\n            onChange: e => setApt(e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 159,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"co-field\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Ville\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 162,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            value: city,\n            readOnly: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 164,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 161,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"co-grid-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"co-field\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Code postal (facultatif)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 170,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            value: zip,\n            onChange: e => setZip(e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 171,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"co-field\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"T\\xE9l\\xE9phone\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 174,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            value: phone,\n            onChange: e => setPhone(e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 175,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 173,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"co-block\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"co-block-title\",\n          children: \"Mode d\\u2019exp\\xE9dition\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 180,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"co-ship-list\",\n          children: rates.map(r => {\n            const checked = r.city === city;\n            return /*#__PURE__*/_jsxDEV(\"label\", {\n              className: `co-ship-row ${checked ? \"is-active\" : \"\"}`,\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"radio\",\n                name: \"ship\",\n                checked: checked,\n                onChange: () => {\n                  setCity(r.city);\n                  setShippingPrice(Number(r.price));\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 186,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"co-ship-city\",\n                children: r.city\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 195,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"co-ship-price\",\n                children: [Number(r.price).toFixed(2), \" MAD\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 196,\n                columnNumber: 19\n              }, this)]\n            }, r.city, true, {\n              fileName: _jsxFileName,\n              lineNumber: 185,\n              columnNumber: 17\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 181,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"co-block\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"co-block-title\",\n          children: \"Paiement\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 204,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"co-pay-row\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"radio\",\n            checked: true,\n            readOnly: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 206,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"co-pay-title\",\n              children: \"Paiement \\xE0 la livraison\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 208,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"co-pay-help\",\n              children: \"Paiement \\xE0 la livraison disponible dans toutes les villes du Maroc. Pas besoin de payer en ligne. Contactez-nous sur WhatsApp pour plus d\\u2019infos.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 209,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 207,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 205,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 9\n      }, this), err && /*#__PURE__*/_jsxDEV(Alert, {\n        variant: \"danger\",\n        className: \"mt-2\",\n        children: err\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"co-submit\",\n        onClick: submit,\n        disabled: loading,\n        children: loading ? \"Validation…\" : \"Valider le paiement\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"co-legal\",\n        children: [/*#__PURE__*/_jsxDEV(Link, {\n          to: \"/privacy\",\n          children: \"Politique de confidentialit\\xE9\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 223,\n          columnNumber: 11\n        }, this), \" \\xB7\", \" \", /*#__PURE__*/_jsxDEV(Link, {\n          to: \"/terms\",\n          children: \"Conditions d\\u2019utilisation\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 224,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"aside\", {\n      className: \"co-right\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"co-summary\",\n        children: items.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"co-empty\",\n          children: \"Votre panier est vide.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 231,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"ul\", {\n            className: \"co-items\",\n            children: items.map(i => /*#__PURE__*/_jsxDEV(\"li\", {\n              className: \"co-item\",\n              children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                src: i.image,\n                alt: i.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 237,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"co-item-info\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"co-item-name\",\n                  children: i.name\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 239,\n                  columnNumber: 23\n                }, this), i.variantLabel && /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"co-item-variant\",\n                  children: i.variantLabel\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 241,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"co-item-qty\",\n                  children: [\"\\xD7 \", i.qty || 1]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 243,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 238,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"co-item-price\",\n                children: [(Number(i.price) * Number(i.qty || 1)).toFixed(2), \" MAD\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 245,\n                columnNumber: 21\n              }, this)]\n            }, i.key, true, {\n              fileName: _jsxFileName,\n              lineNumber: 236,\n              columnNumber: 19\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 234,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"co-line\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Sous-total\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 253,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"b\", {\n              children: [Number(totals.subtotal).toFixed(2), \" MAD\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 254,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 252,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"co-line\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Exp\\xE9dition\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 257,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"b\", {\n              children: [Number(shippingPrice).toFixed(2), \" MAD\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 258,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 256,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"co-total\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Total\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 261,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"b\", {\n              children: [Number(total).toFixed(2), \" MAD\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 262,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 260,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 228,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 131,\n    columnNumber: 5\n  }, this);\n}\n_s(CheckoutPage, \"F+dqY1y+FlNi73xozbxZGGjUEOU=\", false, function () {\n  return [useHistory, useCart];\n});\n_c = CheckoutPage;\nvar _c;\n$RefreshReg$(_c, \"CheckoutPage\");","map":{"version":3,"names":["React","useEffect","useMemo","useState","axios","Alert","Link","useHistory","useCart","jsxDEV","_jsxDEV","Fragment","_Fragment","FALLBACK_RATES","city","price","CheckoutPage","_s","history","items","totals","clear","email","setEmail","first","setFirst","last","setLast","addr","setAddr","apt","setApt","zip","setZip","setCity","phone","setPhone","rates","setRates","shippingPrice","setShippingPrice","loading","setLoading","err","setErr","alive","data","get","Array","isArray","length","normalized","filter","r","active","map","Number","sort","a","b","localeCompare","defaultRate","find","total","subtotal","submit","payload","i","id","name","qty","variant","variantLabel","shipping_price","trim","first_name","last_name","address","payment_method","post","localStorage","setItem","String","order_id","push","e","_e$response","_e$response$data","response","detail","message","className","children","fileName","_jsxFileName","lineNumber","columnNumber","value","onChange","target","readOnly","checked","type","toFixed","onClick","disabled","to","src","image","alt","key","_c","$RefreshReg$"],"sources":["C:/Users/OUSSAMA CHAROUK/Downloads/FullStack_Ecommerce_App-main/frontend/src/pages/CheckoutPage.js"],"sourcesContent":["// src/pages/CheckoutPage.js\nimport React, { useEffect, useMemo, useState } from \"react\";\nimport axios from \"axios\";\nimport { Alert } from \"react-bootstrap\";\nimport { Link, useHistory } from \"react-router-dom\";\nimport { useCart } from \"../cart/CartProvider\";\nimport \"./checkout.css\";\n\nconst FALLBACK_RATES = [\n  { city: \"Casablanca\", price: 20 },\n  { city: \"Ain Harouda\", price: 30 },\n  { city: \"Bouskoura\", price: 30 },\n  { city: \"Dar Bouazza\", price: 30 },\n  { city: \"Errahma ville\", price: 30 },\n  { city: \"Tamaris\", price: 30 },\n  { city: \"Tit Mellil\", price: 30 },\n  { city: \"Agadir\", price: 35 },\n  { city: \"Ait Melloul\", price: 35 },\n  { city: \"Berrechid\", price: 35 },\n  { city: \"Marrakech : Tamansourt\", price: 45 },\n  { city: \"Mohammedia : Mimosa\", price: 45 },\n  { city: \"Livraison pour toutes les autres villes\", price: 45 },\n];\n\nexport default function CheckoutPage() {\n  const history = useHistory();\n  const { items, totals, clear } = useCart();\n\n  const [email, setEmail] = useState(\"\");\n  const [first, setFirst] = useState(\"\");\n  const [last, setLast] = useState(\"\");\n  const [addr, setAddr] = useState(\"\");\n  const [apt, setApt] = useState(\"\");\n  const [zip, setZip] = useState(\"\");\n  const [city, setCity] = useState(\"\");\n  const [phone, setPhone] = useState(\"\");\n\n  const [rates, setRates] = useState(FALLBACK_RATES);\n  const [shippingPrice, setShippingPrice] = useState(0);\n  const [loading, setLoading] = useState(false);\n  const [err, setErr] = useState(\"\");\n\n  // load shipping rates (public endpoint already added in your backend)\n  useEffect(() => {\n    let alive = true;\n    (async () => {\n      try {\n        const { data } = await axios.get(\"/api/shipping-rates/\");\n        if (!alive) return;\n        if (Array.isArray(data) && data.length) {\n          const normalized = data\n            .filter((r) => r.active !== false)\n            .map((r) => ({ city: r.city, price: Number(r.price) }))\n            .sort((a, b) => a.city.localeCompare(b.city, \"fr\"));\n          setRates(normalized);\n        }\n      } catch {\n        // fallback already set\n      }\n    })();\n    return () => { alive = false; };\n  }, []);\n\n  // preselect Casablanca (or first rate)\n  useEffect(() => {\n    if (!rates.length) return;\n    const defaultRate = rates.find((r) => r.city === \"Casablanca\") || rates[0];\n    setCity(defaultRate.city);\n    setShippingPrice(defaultRate.price);\n  }, [rates]);\n\n  const total = useMemo(\n    () => (totals.subtotal || 0) + Number(shippingPrice || 0),\n    [totals.subtotal, shippingPrice]\n  );\n\n  const submit = async () => {\n    setErr(\"\");\n    if (!items.length) {\n      setErr(\"Votre panier est vide.\");\n      return;\n    }\n    if (!addr || !city || !phone) {\n      setErr(\"Adresse, ville et téléphone sont obligatoires.\");\n      return;\n    }\n\n    setLoading(true);\n    try {\n      const payload = {\n        // order summary\n        items: items.map((i) => ({\n          id: i.id,\n          name: i.name,\n          price: Number(i.price),\n          qty: Number(i.qty || 1),\n          variant: i.variantLabel || \"\",\n        })),\n        subtotal: Number(totals.subtotal),\n        shipping_price: Number(shippingPrice),\n        total: Number(total),\n\n        // contact + shipping address\n        email: (email || \"\").trim(),\n        first_name: (first || \"\").trim(),\n        last_name: (last || \"\").trim(),\n        address: `${addr}${apt ? \", \" + apt : \"\"}${\n          zip ? \", \" + zip : \"\"\n        }`.trim(),\n        city,\n        phone: (phone || \"\").trim(),\n\n        // payment method\n        payment_method: \"cod\", // cash on delivery\n      };\n\n      // New backend endpoint below\n      const { data } = await axios.post(\"/api/checkout/cod/\", payload);\n      // Save for the status page\n      localStorage.setItem(\"lastOrderId\", String(data.order_id));\n      clear(); // empty cart after placing order\n      history.push(`/payment-status?order=${data.order_id}`);\n    } catch (e) {\n      setErr(e?.response?.data?.detail || e.message || \"Erreur serveur\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"co-wrap\">\n      <div className=\"co-left\">\n        <h2 className=\"co-title\">Contact</h2>\n        <div className=\"co-field\">\n          <label>E-mail ou numéro de portable</label>\n          <input value={email} onChange={(e) => setEmail(e.target.value)} />\n        </div>\n\n        <h2 className=\"co-title\">Livraison</h2>\n        <div className=\"co-grid-2\">\n          <div className=\"co-field\">\n            <label>Prénom (optionnel)</label>\n            <input value={first} onChange={(e) => setFirst(e.target.value)} />\n          </div>\n          <div className=\"co-field\">\n            <label>Nom</label>\n            <input value={last} onChange={(e) => setLast(e.target.value)} />\n          </div>\n        </div>\n\n        <div className=\"co-field\">\n          <label>Adresse</label>\n          <input value={addr} onChange={(e) => setAddr(e.target.value)} />\n        </div>\n\n        <div className=\"co-grid-2\">\n          <div className=\"co-field\">\n            <label>Appartement, suite, etc. (optionnel)</label>\n            <input value={apt} onChange={(e) => setApt(e.target.value)} />\n          </div>\n          <div className=\"co-field\">\n            <label>Ville</label>\n            {/* We'll sync with shipping list below, so this input is read-only */}\n            <input value={city} readOnly />\n          </div>\n        </div>\n\n        <div className=\"co-grid-2\">\n          <div className=\"co-field\">\n            <label>Code postal (facultatif)</label>\n            <input value={zip} onChange={(e) => setZip(e.target.value)} />\n          </div>\n          <div className=\"co-field\">\n            <label>Téléphone</label>\n            <input value={phone} onChange={(e) => setPhone(e.target.value)} />\n          </div>\n        </div>\n\n        <div className=\"co-block\">\n          <div className=\"co-block-title\">Mode d’expédition</div>\n          <div className=\"co-ship-list\">\n            {rates.map((r) => {\n              const checked = r.city === city;\n              return (\n                <label key={r.city} className={`co-ship-row ${checked ? \"is-active\" : \"\"}`}>\n                  <input\n                    type=\"radio\"\n                    name=\"ship\"\n                    checked={checked}\n                    onChange={() => {\n                      setCity(r.city);\n                      setShippingPrice(Number(r.price));\n                    }}\n                  />\n                  <span className=\"co-ship-city\">{r.city}</span>\n                  <span className=\"co-ship-price\">{Number(r.price).toFixed(2)} MAD</span>\n                </label>\n              );\n            })}\n          </div>\n        </div>\n\n        <div className=\"co-block\">\n          <div className=\"co-block-title\">Paiement</div>\n          <div className=\"co-pay-row\">\n            <input type=\"radio\" checked readOnly />\n            <div>\n              <div className=\"co-pay-title\">Paiement à la livraison</div>\n              <div className=\"co-pay-help\">\n                Paiement à la livraison disponible dans toutes les villes du Maroc.  \n                Pas besoin de payer en ligne. Contactez-nous sur WhatsApp pour plus d’infos.\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {err && <Alert variant=\"danger\" className=\"mt-2\">{err}</Alert>}\n\n        <button className=\"co-submit\" onClick={submit} disabled={loading}>\n          {loading ? \"Validation…\" : \"Valider le paiement\"}\n        </button>\n        <div className=\"co-legal\">\n          <Link to=\"/privacy\">Politique de confidentialité</Link> ·{\" \"}\n          <Link to=\"/terms\">Conditions d’utilisation</Link>\n        </div>\n      </div>\n\n      <aside className=\"co-right\">\n        <div className=\"co-summary\">\n          {items.length === 0 ? (\n            <div className=\"co-empty\">Votre panier est vide.</div>\n          ) : (\n            <>\n              <ul className=\"co-items\">\n                {items.map((i) => (\n                  <li key={i.key} className=\"co-item\">\n                    <img src={i.image} alt={i.name} />\n                    <div className=\"co-item-info\">\n                      <div className=\"co-item-name\">{i.name}</div>\n                      {i.variantLabel && (\n                        <div className=\"co-item-variant\">{i.variantLabel}</div>\n                      )}\n                      <div className=\"co-item-qty\">× {i.qty || 1}</div>\n                    </div>\n                    <div className=\"co-item-price\">\n                      {(Number(i.price) * Number(i.qty || 1)).toFixed(2)} MAD\n                    </div>\n                  </li>\n                ))}\n              </ul>\n\n              <div className=\"co-line\">\n                <span>Sous-total</span>\n                <b>{Number(totals.subtotal).toFixed(2)} MAD</b>\n              </div>\n              <div className=\"co-line\">\n                <span>Expédition</span>\n                <b>{Number(shippingPrice).toFixed(2)} MAD</b>\n              </div>\n              <div className=\"co-total\">\n                <span>Total</span>\n                <b>{Number(total).toFixed(2)} MAD</b>\n              </div>\n            </>\n          )}\n        </div>\n      </aside>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}